<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>RO Calculator</title>
    <script src="https://unpkg.com/vue"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>

    <!-- <style type="text/css">
        #equipinput {
            display: inline;
            padding: 0 20px;
        }
    </style> -->
    <style>
        .el-row {
            margin-bottom: 5px;
        }

        .el-col {
            border-radius: 4px;
        }

        .bg-purple-dark {
            background: #99a9bf;
        }

        .bg-purple {
            background: #d3dce6;
        }

        .bg-purple-light {
            background: #e5e9f2;
        }

        .grid-content {
            border-radius: 4px;
            min-height: 36px;
        }

        .row-bg {
            padding: 10px 0;
            background-color: #f9fafc;
        }
    </style>
</head>

<body>

    <el-container>
        <div class="Equipment" id="equipment">
            <el-form :inline="true" label-width="100px">
                <el-form-item>
                    <el-input v-model="equipname" placeholder="裝備名稱"></el-input>
                </el-form-item>
            </el-form>
            <el-form class="Input" id="equipinput" :inline="true">
                <el-form-item>
                    <el-select value-key="id" v-model="input.EffectType" v-on:change="onSelectedDrug"
                        placeholder="選擇效果">
                        <el-option v-for="item in types" :key="item.id" :label="item.label" :value="item">
                        </el-option>
                    </el-select>
                </el-form-item>
                <el-form-item>
                    <el-input v-model="input.EffectNumber" placeholder="效果參數"></el-input>
                </el-form-item>
                <el-form-item>
                    <el-button v-on:click="AddEffect" type="primary" plain>+</el-button>
                </el-form-item>
            </el-form>
            <el-form size="small">
                <div class="Item bg-purple-light" v-for="(item, index) in contacts" v-bind:key="item.types">
                    <el-form :inline="true" label-width="50px">
                        <el-form-item><span class="EffectType">{{ item.EffectType}}</span></el-form-item>
                        <el-form-item><span class="EffectNumber">{{ item.EffectNumber}}</span></el-form-item>
                        <el-form-item>
                            <el-button v-on:click="RemoveEffect(item)" type="primary" plain>-</el-button>
                        </el-form-item>
                    </el-form>
                </div>
            </el-form>
        </div>
    </el-container>

    <script>
        evue = new Vue({
            el: '#equipment',
            data: {
                equipname: '',
                contacts: [],
                blockRemoval: true,
                types: [
                    { label: 'ATK', id: 'ATK' },
                    { label: 'ATK%', id: 'ATKPercent' },
                    { label: 'Matk', id: 'Matk' },
                    { label: 'Matk%', id: 'MatkPercent' }
                ],
                input: {
                    EffectType: this.types,
                    EffectNumber: ''
                }
            },
            methods: {
                AddEffect() {
                    // let obj = {};
                    // obj = this.types.find((item)=>{
                    //     return item.id === this.input.EffectType;
                    // });
                    // console.log(obj.id);
                    if( this.contacts.length >0 )
                    {
                        let index = this.contacts.filter(function(x){ return this.input.EffectType===x.EffectType; } );
                        console.log(index);
                    }
                    this.contacts.push({
                        EffectNumber: this.input.EffectNumber,
                        EffectType: this.input.EffectType.label,
                    })
                    console.log("AddEffect Type: " + this.input.EffectType + " /" + this.input.EffectNumber);
                },
                RemoveEffect(item) {
                    console.log("RemoveEffect: " + item);
                    var index = this.contacts.indexOf(item)
                    if (index !== -1) {
                        this.contacts.splice(index, 1)
                    }
                },
                onSelectedDrug(item) {
                    console.log("onSelectedDrug " + item.label);
                    //this.input.EffectType = item.label;
                },
            },
            mounted() {
                console.log("mounted");
                // this.contacts.push({
                //     EffectNumber: 'TestNumber',
                //     EffectType: 'TestType',
                // })
            }
        })
    </script>

    <body>

</html>