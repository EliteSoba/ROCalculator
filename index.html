<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>RO Calculator</title>
    <script src="https://unpkg.com/vue"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://unpkg.com/linq"></script>

    <!-- <style type="text/css">
        #equipinput {
            display: inline;
            padding: 0 20px;
        }
    </style> -->
    <style>
        .el-row {
            margin-bottom: 4px;
        }

        .el-col {
            border-radius: 4px;
        }

        .bg-purple-dark {
            background: #99a9bf;
        }

        .bg-purple {
            background: #d3dce6;
        }

        .bg-purple-light {
            background: #e5e9f2;
        }

        .grid-content {
            border-radius: 4px;
            min-height: 36px;
        }

        .row-bg {
            padding: 10px 0;
            background-color: #f9fafc;
        }

        .effectline {
            line-height: 3;
            margin: auto;
        }

        .boxborder {
            padding: 5px 5px;
            border: 1px solid #d7dae2;
            border-radius: 4px;
            min-height: 100px;
        }

        .statusbox {
            border: 1px solid #d7dae2;
            border-radius: 2px;
            min-height: 10px;
        }

        .optionbox {
            border: 1px solid #d7dae2;
            border-radius: 2px;
            min-height: 40px;
            text-align: center;
        }

        .textcenter {
            text-align: center;
        }

        .titlebox {
            border: 1px solid #d7dae2;
            border-radius: 2px;
            min-height: 40px;
            text-align: center;
        }
    </style>
</head>

<body>
    <el-container id="equipment">
        <el-dialog :visible.sync="EquipEffectDialogVisible" @close="CloseEffectDialogue" width="33%">
            <span slot="title">增加 <b>{{EquipSelectLabel}}</b> 裝備效果</span>
            <el-row class="bg-purple" :gutter="6">
                <el-col :span="11">
                    <div>
                        <el-select value-key="id" v-model="effectdialogue.EffectType" v-on:change="onSelectedDrug"
                            placeholder="選擇效果">
                            <el-option v-for="item in effecttypelist" :key="item.id" :label="item.label" :value="item">
                            </el-option>
                        </el-select>
                    </div>
                </el-col>
                <el-col :span="8">
                    <div>
                        <el-input v-model="effectdialogue.EffectNumber" v-on:keyup.enter.native="AddEffect"
                            placeholder="效果參數">
                        </el-input>
                    </div>
                </el-col>
                <el-col :span="5">
                    <div>
                        <el-button v-on:click="AddEffect" type="success" plain>
                            確定
                        </el-button>
                    </div>
                </el-col>
            </el-row>
        </el-dialog>
        <el-dialog :visible.sync="EquipDBDialogVisible" width="50%">
            <span slot="title">載入裝備資料</span>
            <el-row :gutter="6">
                    <el-row class="effectline" :gutter="4" type="flex" align="middle" style="height:40px;">
                            <el-col class="textcenter" :span="4" style="text-align: right;">
                                <span class="">部位</span>
                            </el-col>
                            <el-col class="textcenter">
                                <span class="">裝備名字</span>
                            </el-col>
                            <el-col :span="4"> 
                            </el-col>
                            <el-col :span="6"> 
                            </el-col>
                            <el-col :span="5"> 
                            </el-col>
                    </el-row>
                <div v-for="(item, index) in StoreDB_Equip" v-bind:key="item.uuid">
                    <el-row class="optionbox effectline" :gutter="4" type="flex" align="middle" style="height:40px;">
                        
                        <el-col class="textcenter" :span="4" style="text-align: right;">
                            <span class="EffectType">{{ item.equip.label }}</span>
                        </el-col>
                        <el-col class="textcenter" >
                            <span class="">{{ item.equip.equipname }}</span>
                        </el-col>
                        <el-col :span="4">
                            <el-button v-on:click="onRemoveEquipSave(index)" type="danger" size="mini">
                                刪除
                            </el-button>
                        </el-col>
                        <el-col :span="6">
                            <el-button v-on:click="onLoadEquipSave(index)" type="success" type="primary" size="small">
                                載入
                            </el-button>
                        </el-col>
                        <el-col :span="5">
                        </el-col>
                    </el-row>
                </div>
            </el-row>
        </el-dialog>
        <el-header>
            <el-row>
                <el-col :span="24">
                    <div class="effectline grid-content bg-purple-dark" type="flex" align="middle" justify="center">
                        <span>RO Calculator</span>
                    </div>
                </el-col>
            </el-row>
        </el-header>
        <el-main>
            <el-row :gutter="2">
                <el-col :span="8">
                    <el-row class="titlebox" type="flex" align="middle" justify="space-around" style="height:40px;">
                        <el-col class="textcenter" :span="10">
                            <span class="textcenter">角色素質</span>
                        </el-col>
                    </el-row>
                    <el-row>
                        <div class="boxborder StatusBlock">
                            <el-row class="statusbox bg-purple-light" type="flex" align="middle" style="height:40px;">
                                <el-col class="textcenter">Level</el-col>
                                <el-col>
                                    <el-input v-model="status.Level" v-on:input="onChaneStatus" placeholder="Level">
                                    </el-input>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" type="flex" align="middle" style="height:40px;">
                                <el-col class="textcenter">STR</el-col>
                                <el-col>
                                    <el-input v-model="status.STR" v-on:input="onChaneStatus" placeholder="STR">
                                    </el-input>
                                </el-col>
                                <el-col class="textcenter">{{status.STR_Total}}</el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" type="flex" align="middle" style="height:40px;">
                                <el-col class="textcenter">AGI</el-col>
                                <el-col>
                                    <el-input v-model="status.AGI" v-on:input="onChaneStatus" placeholder="AGI">
                                    </el-input>
                                </el-col>
                                <el-col class="textcenter">{{status.AGI_Total}}</el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" type="flex" align="middle" style="height:40px;">
                                <el-col class="textcenter">VIT</el-col>
                                <el-col>
                                    <el-input v-model="status.VIT" v-on:input="onChaneStatus" placeholder="VIT">
                                    </el-input>
                                </el-col>
                                <el-col class="textcenter">{{status.VIT_Total}}</el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" type="flex" align="middle" style="height:40px;">
                                <el-col class="textcenter">INT</el-col>
                                <el-col>
                                    <el-input v-model="status.INT" v-on:input="onChaneStatus" placeholder="INT">
                                    </el-input>
                                </el-col>
                                <el-col class="textcenter">{{status.INT_Total}}</el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" type="flex" align="middle" style="height:40px;">
                                <el-col class="textcenter">DEX</el-col>
                                <el-col>
                                    <el-input v-model="status.DEX" v-on:input="onChaneStatus" placeholder="DEX">
                                    </el-input>
                                </el-col>
                                <el-col class="textcenter">{{status.DEX_Total}}</el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" type="flex" align="middle" style="height:40px;">
                                <el-col class="textcenter">LUK</el-col>
                                <el-col>
                                    <el-input v-model="status.LUK" v-on:input="onChaneStatus" placeholder="LUK">
                                    </el-input>
                                </el-col>
                                <el-col class="textcenter">{{status.LUK_Total}}</el-col>
                            </el-row>
                        </div>
                    </el-row>
                    <el-row class="titlebox" type="flex" align="middle" justify="space-around" style="height:40px;">
                        <el-col class="textcenter" :span="10">
                            <span class="textcenter">敵方</span>
                        </el-col>
                    </el-row>
                    <el-row>
                        <div class="boxborder EnemyBlock">
                            <el-row class="statusbox bg-purple-light" :gutter="4" type="flex" align="middle"
                                justify="center">
                                <el-col :span="24">
                                    <div class="textcenter grid-content">
                                        <el-select value-key="id" v-model="enemyattribute" v-on:change="onSelectEnemy"
                                            placeholder="選擇敵方">
                                            <el-option v-for="item in enemylist" :key="item.id" :label="item.name"
                                                :value="item">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" :gutter="4" type="flex" align="middle">
                                <el-col :span="3" class="textcenter"><span>屬性</span>
                                </el-col>
                                <el-col :span="5">
                                    <div class="grid-content bg-purple">
                                        <el-select v-model="enemyattribute.elemental"
                                            v-on:change="ComputElementalPercent" placeholder="敵方屬性">
                                            <el-option v-for="item in elementtypelist" :key="item.id"
                                                :label="item.label" :value="item.id">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </el-col>
                                <el-col :span="4" class="textcenter"><span>屬性等級</span>
                                </el-col>
                                <el-col :span="3">
                                    <div class="grid-content bg-purple">
                                        <el-select value-key="id" v-model="enemyattribute.elementallevel"
                                            v-on:change="ComputElementalPercent" placeholder="屬性等級">
                                            <el-option v-for="item in elementlevel" :key="item.id" :label="item.id"
                                                :value="item.id">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </el-col>
                                <el-col :span="4" class="textcenter">體型</el-col>
                                <el-col :span="5">
                                    <div class="grid-content bg-purple">
                                        <el-select value-key="id" v-model="enemyattribute.size" placeholder="體型">
                                            <el-option v-for="item in sizetypelist" :key="item.id" :label="item.label"
                                                :value="item.id">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </el-col>
                            </el-row>

                            <el-row class="statusbox bg-purple-light" :gutter="4" type="flex" align="middle">
                                <el-col class="textcenter">前 DEF</el-col>
                                <el-col>
                                    <el-input v-model="enemyattribute.StatusDEF" v-on:input="onChangeEnemyStatus"
                                        placeholder="前 DEF">
                                    </el-input>
                                </el-col>
                                <el-col class="textcenter">後 DEF</el-col>
                                <el-col>
                                    <el-input v-model="enemyattribute.WeaponDEF" v-on:input="onChangeEnemyStatus"
                                        placeholder="後 DEF">
                                    </el-input>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" :gutter="4" type="flex" align="middle">
                                <el-col class="textcenter">前 MDEF</el-col>
                                <el-col>
                                    <el-input v-model="enemyattribute.StatusMDEF" v-on:input="onChangeEnemyStatus"
                                        placeholder="前 MDEF">
                                    </el-input>
                                </el-col>
                                <el-col class="textcenter">後 MDEF</el-col>
                                <el-col>
                                    <el-input v-model="enemyattribute.WeaponMDEF" v-on:input="onChangeEnemyStatus"
                                        placeholder="後 MDEF">
                                    </el-input>
                                </el-col>
                            </el-row>
                        </div>
                    </el-row>
                    <el-row class="titlebox" type="flex" align="middle" justify="space-around" style="height:40px;">
                        <el-col class="textcenter" :span="10">
                            <span class="textcenter">技能選項</span>
                        </el-col>
                    </el-row>
                    <el-row>
                        <div class="boxborder OptionBlock">
                            <el-row class="statusbox bg-purple-light" :gutter="4" type="flex" align="middle">
                                <el-col class="textcenter" :span="24">
                                    <span>攻擊屬性</span>
                                </el-col>
                                <el-col :span="24">
                                    <div class="textcenter">
                                        <el-select value-key="id" v-model="option.AttackElementalIdx"
                                            v-on:change="ComputElementalPercent" placeholder="攻擊屬性">
                                            <el-option v-for="item in elementtypelist" :key="item.id"
                                                :label="item.label" :value="item.id">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" :gutter="4" type="flex" align="middle">
                                <el-col class="textcenter" :span="12">技能倍率</el-col>
                                <el-col :span="8">
                                    <el-input v-model="option.SkillPercent" v-on:input="onOptionSkill"
                                        placeholder="Skill %">
                                    </el-input>
                                </el-col>
                                <el-col class="textcenter" :span="4">%</el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" :gutter="4" type="flex" align="middle">
                                <el-col class="textcenter" :span="12">裝備技能傷害增加</el-col>
                                <el-col :span="8">
                                    <el-input v-model="option.EquipSkillAddDamage" v-on:input="onOptionSkill"
                                        placeholder="Skill %">
                                    </el-input>
                                </el-col>
                                <el-col class="textcenter" :span="4">%</el-col>
                            </el-row>
                            <el-row class="statusbox bg-purple-light" :gutter="4" type="flex" align="middle">
                                <el-col class="textcenter">武器修練ATK增加</el-col>
                                <el-col>
                                    <el-input v-model="option.WeaponMasteryATK" v-on:input="onOptionWeaponMastery"
                                        placeholder="ATK">
                                    </el-input>
                                </el-col>
                            </el-row>
                            <el-row>
                                <el-collapse>
                                    <el-collapse-item>
                                        <template slot="title" align="center">
                                            <div class="textcenter">劍士</div>
                                        </template>

                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>騎乘</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.Riding" v-on:change="ComputeSizefix"
                                                    active-color="#13ce66" inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>怒爆</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.MagnumBreak"
                                                    v-on:change="onOptionMagnumBreak" active-color="#13ce66"
                                                    inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>集中攻擊</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.Concentration"
                                                    v-on:change="onOptionConcentration" active-color="#13ce66"
                                                    inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>狂怒之槍</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.Berserk" v-on:change="onOptionBerserk"
                                                    active-color="#13ce66" inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                    </el-collapse-item>
                                    <el-collapse-item>
                                        <template slot="title">
                                            <div class="textcenter">盜賊</div>
                                        </template>

                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>致命塗毒</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.EnchantDeadlyPoison"
                                                    v-on:change="onOptionEnchantDeadlyPoison" active-color="#13ce66"
                                                    inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>高階拳刃修練</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.AdvancedKatarReserch"
                                                    v-on:change="onOptionAdvancedKatarReserch" active-color="#13ce66"
                                                    inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                    </el-collapse-item>
                                    <el-collapse-item>
                                        <template slot="title">
                                            <div class="textcenter">商人</div>
                                        </template>

                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>武器值最大化</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.MaximizePower" v-on:change="ComputeSizefix"
                                                    active-color="#13ce66" inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>無視體型攻擊</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.WeaponPerfection"
                                                    v-on:change="ComputeSizefix" active-color="#13ce66"
                                                    inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>兇砍</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.Overthrust" v-on:change="onOptionOverthrust"
                                                    active-color="#13ce66" inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>兇砍最大值</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.OverthrustMax"
                                                    v-on:change="onOptionOverthrustMax" active-color="#13ce66"
                                                    inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                    </el-collapse-item>
                                    <el-collapse-item>
                                        <template slot="title">
                                            <div class="textcenter">弓箭手</div>
                                        </template>
                                    </el-collapse-item>
                                    <el-collapse-item>
                                        <template slot="title">
                                            <div class="textcenter">法師</div>
                                        </template>

                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>打擊強化</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.Striking" v-on:change="onOptionStriking"
                                                    active-color="#13ce66" inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                    </el-collapse-item>
                                    <el-collapse-item>
                                        <template slot="title">
                                            <div class="textcenter">服事</div>
                                        </template>

                                        <el-row class="optionbox" :gutter="4" type="flex" align="middle" justify="end">
                                            <el-col class="textcenter" :span="12">
                                                <span>點穴-反</span>
                                            </el-col>
                                            <el-col class="textcenter" :span="12">
                                                <el-switch v-model="option.GentleTouchCharge"
                                                    v-on:change="onOptionGentleTouchCharge" active-color="#13ce66"
                                                    inactive-color="#8a9799">
                                                </el-switch>
                                            </el-col>
                                        </el-row>
                                    </el-collapse-item>
                                </el-collapse>
                            </el-row>
                        </div>
                    </el-row>
                </el-col>
                <el-col :span="8">
                    <el-row class="titlebox" type="flex" align="middle" justify="space-around" style="height:40px;">
                        <el-col class="textcenter" :span="10">
                            <span class="textcenter">裝備</span>
                        </el-col>
                        <el-col class="textcenter" :span="6" style="text-align: right;">
                            <el-button v-on:click="OpenEquipDBDialogDialogue">
                                載入
                            </el-button>
                        </el-col>
                    </el-row>
                    <el-row>
                        <div class="boxborder EquipBlock">

                            <div class="Item bg-purple-light" v-for="(item,eqindex) in equipspartlist">
                                <div class="Equipment">
                                    <el-row class="effectline" :gutter="4" type="flex" align="middle">
                                        <el-col class="textcenter" :span="4">
                                            <div>
                                                <span>{{item.label}}</span>
                                            </div>
                                        </el-col>
                                        <el-col :span="10">
                                            <div>
                                                <el-input v-model="equipspartlist[eqindex].equipname"
                                                    placeholder="裝備名稱">
                                                </el-input>
                                            </div>
                                        </el-col>
                                        <el-col :span="5">
                                            <el-button v-on:click="OpenEffectDialogue(eqindex)" type="success" plain>
                                                增加效果
                                            </el-button>
                                        </el-col>
                                        <el-col :span="5">
                                            <el-button v-on:click="onSaveEquip(eqindex)">
                                                儲存
                                            </el-button>
                                        </el-col>
                                    </el-row>
                                    <el-row>
                                        <el-col :span="24">
                                            <el-row>
                                                <div v-for="(item, index) in equipspartlist[eqindex].effectlist"
                                                    v-bind:key="item.effecttypelist">
                                                    <el-row class="effectline" :gutter="4" type="flex" align="middle"
                                                        style="height:40px;">
                                                        <el-col class="bg-purple" :span="2">
                                                        </el-col>
                                                        <el-col class="textcenter" :span="6" style="text-align: right;">
                                                            <span class="EffectType">{{ item.EffectType.label }}</span>
                                                        </el-col>
                                                        <el-col class="textcenter" :span="2">
                                                            <span class="">{{ item.EffectType.opersymbol }}</span>
                                                        </el-col>
                                                        <el-col class="textcenter" :span="2">
                                                            <span class="">{{ item.EffectNumber }}</span>
                                                        </el-col>
                                                        <el-col class="textcenter" :span="2 ">
                                                            <span lass="">{{ item.EffectType.suffixsymbol }}</span>
                                                        </el-col>
                                                        <el-col :span="5">
                                                            <el-button v-on:click="RemoveEffect(eqindex, index)"
                                                                type="danger" size="mini">
                                                                Del
                                                            </el-button>
                                                        </el-col>
                                                        <el-col :span="5">
                                                        </el-col>
                                                    </el-row>
                                                </div>
                                            </el-row>
                                        </el-col>
                                    </el-row>
                                </div>
                            </div>
                        </div>
                    </el-row>
                    <el-row class="titlebox" type="flex" align="middle" justify="space-around" style="height:40px;">
                        <el-col class="textcenter" :span="10">
                            <span class="textcenter">武器</span>
                        </el-col>
                    </el-row>
                    <el-row>
                        <div class="boxborder WeaponBlock bg-purple-light">
                            <el-row :gutter="4" type="flex" align="middle">
                                <el-col :span="4">
                                    <span>武器等級</span>
                                </el-col>
                                <el-col :span="8">
                                    <div class="grid-content bg-purple">
                                        <el-select value-key="id" v-model="weapon.level"
                                            v-on:change="onSelectedWeaponLevel" placeholder="武器等級">
                                            <el-option v-for="item in weaponlevellist" :key="item.id"
                                                :label="item.label" :value="item">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </el-col>
                                <el-col :span="7">
                                    <span>精鍊等級</span>
                                </el-col>
                                <el-col :span="5">
                                    <div class="grid-content bg-purple-light">
                                        <el-input v-model="weapon.refinelevel" v-on:input="onChangeRefineLevel"
                                            placeholder="精鍊等級">
                                        </el-input>
                                    </div>
                                </el-col>
                            </el-row>
                            <el-row class="effectline" :gutter="4" type="flex" align="middle" justify="end">
                                <el-col :span="4">
                                    <span>主手武器</span>
                                </el-col>
                                <el-col :span="8">
                                    <div class="grid-content bg-purple">
                                        <el-select value-key="id" v-model="weapon.type"
                                            v-on:change="onSelectedWeaponType" placeholder="武器類型">
                                            <el-option v-for="item in weapontypelist" :key="item.id" :label="item.label"
                                                :value="item">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </el-col>
                                <el-col class="textcenter" :span="12">
                                    <el-checkbox v-model="lefthandweapon" label="副手持武" border></el-checkbox>
                                </el-col>
                            </el-row>
                            <el-row class="effectline" :gutter="4" type="flex" align="middle">
                                <el-col :span="6">
                                    <span>武器ATK: </span>
                                </el-col>
                                <el-col :span="6">
                                    <div class="grid-content bg-purple-light">
                                        <el-input v-model="weapon.ATK" placeholder="武器ATK">
                                        </el-input>
                                    </div>
                                </el-col>
                                <el-col :span="6">
                                    <span>武器MATK: </span>
                                </el-col>
                                <el-col :span="6">
                                    <div class="grid-content bg-purple-light">
                                        <el-input v-model="weapon.MATK" v-on:input="ComputeMATKAtttibute"
                                            placeholder="武器MATK">
                                        </el-input>
                                    </div>
                                </el-col>
                            </el-row>
                            <el-row class="effectline" :gutter="4" type="flex" align="middle">
                                <el-col :span="6">
                                    <span>箭矢ATK: </span>
                                </el-col>
                                <el-col :span="6">
                                    <div class="grid-content bg-purple-light">
                                        <el-input v-model="weapon.ArrowATK" placeholder="箭矢ATK">
                                        </el-input>
                                    </div>
                                </el-col>
                                <el-col :span="6">
                                    <span>砲彈ATK: </span>
                                </el-col>
                                <el-col :span="6">
                                    <div class="grid-content bg-purple-light">
                                        <el-input v-model="weapon.BulletATK" placeholder="砲彈ATK">
                                        </el-input>
                                    </div>
                                </el-col>
                            </el-row>
                            <el-row class="bg-purple effectline" type="flex" align="middle" justify="center">
                                <el-col :span="24">
                                    <span>精鍊Atk/Matk: {{weapon.refineatk}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="bg-purple effectline" type="flex" align="middle" justify="center">
                                <el-col :span="24">
                                    <span>過度精鍊Atk/Matk: {{weapon.refineatk2}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="bg-purple effectline" type="flex" align="middle" justify="center">
                                <el-col :span="24">
                                    <span>體型修正: {{weapon.sizefix}}</span>
                                </el-col>
                            </el-row>
                        </div>
                    </el-row>
                    <el-row class="titlebox" type="flex" align="middle" justify="space-around" style="height:40px;">
                        <el-col class="textcenter" :span="10">
                            <span class="textcenter">裝備效果整合</span>
                        </el-col>
                    </el-row>
                    <el-row>
                        <div class="boxborder EffectListBlock">
                            <el-row>
                                <el-col :span="24">
                                    <el-row>
                                        <div v-for="(item, id) in this.effecttypelist" v-bind:key="item.id">

                                            <el-row v-if="item.totalvalue!=0" class="statusbox bg-purple" type="flex"
                                                align="middle" justify="center" style="height:40px;">
                                                <el-col class="textcenter" :span="6" style="text-align: right;">
                                                    <span>{{ item.label }}</span>
                                                </el-col>
                                                <el-col class="textcenter" :span="2">
                                                    <span class="">{{ item.opersymbol }}</span>
                                                </el-col>
                                                <el-col class="textcenter" :span="2">
                                                    <span>{{item.totalvalue}}</span>
                                                </el-col>
                                                <el-col class="textcenter" :span="2 ">
                                                    <span lass="">{{ item.suffixsymbol }}</span>
                                                </el-col>
                                            </el-row>
                                        </div>
                                    </el-row>
                                </el-col>
                            </el-row>
                        </div>
                    </el-row>
                </el-col>

                <el-col :span="8">
                    <el-row>
                        <div class="Attribute">
                            <el-row class="titlebox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="textcenter" :span="10">
                                    <span class="textcenter">一般</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>素質Atk(前):</span>
                                </el-col>
                                <el-col class="textcenter" :span="10">
                                    <span>{{attritube.StatusATK}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>素質Matk(前):</span>
                                </el-col>
                                <el-col class="textcenter" :span="10">
                                    <span>{{attritube.StatusMATK}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>屬性倍率:</span>
                                </el-col>
                                <el-col class="textcenter" :span="10">
                                    <span>{{option.ElementalPercent}} %</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>體型倍率:</span>
                                </el-col>
                                <el-col class="textcenter" :span="10">
                                    <span>{{computeattribute.sizefix}} %</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>敵方防禦:</span>
                                </el-col>
                                <el-col class="textcenter" :span="10">
                                    <span>{{option.enemydef}} %</span>
                                </el-col>
                            </el-row>
                            <el-row class="titlebox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="textcenter" :span="10">
                                    <span class="textcenter">ATK計算</span>
                                </el-col>
                            </el-row>

                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>基礎ATK:</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc0_min}}~{{computeattribute.atkc0_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc0_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>+精練+特殊加值</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc1_min}}~{{computeattribute.atkc1_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc1_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>*體型修正+箭矢</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc2_min}}~{{computeattribute.atkc2_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc2_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>武器ATK</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.weaponatk_min}}~{{computeattribute.weaponatk_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.weaponatk_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>裝備ATK</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.atkequip_min}}~{{computeattribute.atkequip_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.atkequip_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>霸氣ATK%</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.atkbranch_min}}~{{computeattribute.atkbranch_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.atkbranch_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>上兩加總</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc4_min}}~{{computeattribute.atkc4_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc4_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>屬性素質ATK</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc5_min}}~{{computeattribute.atkc5_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc5_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>遠傷ATK</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc6_min}}~{{computeattribute.atkc6_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc6_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>技能倍率DEF</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc7_min}}~{{computeattribute.atkc7_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc7_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>爆傷技能增傷</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc8_min}}~{{computeattribute.atkc8_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.atkc8_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>普攻傷害</span>
                                </el-col>
                                <el-col v-if="option.MaximizePower==false" class="textcenter" :span="10">
                                    <span>{{computeattribute.normalattack_min}}~{{computeattribute.normalattack_max}}</span>
                                </el-col>
                                <el-col v-else class="textcenter" :span="10">
                                    <span>{{computeattribute.normalattack_max}}</span>
                                </el-col>
                            </el-row>
                            <el-row class="statusbox" type="flex" align="middle" justify="space-around"
                                style="height:40px;">
                                <el-col class="bg-purple-light" :span="10" style="text-align: right;">
                                    <span>普攻爆傷</span>
                                </el-col>
                                <el-col class="textcenter" :span="10">
                                    <span>{{computeattribute.normalcritical}}</span>
                                </el-col>
                            </el-row>

                        </div>
                    </el-row>
                </el-col>
            </el-row>

        </el-main>
        <el-footer>
            <el-row>
                <el-col>
                    <div class="bg-purple" type="flex" align="middle" justify="center">
                        Copyright(c) Landgris</br>
                        <a target="_blank" href="https://twitter.com/Landgris">Twitter</a>
                    </div>
                </el-col>
            </el-row>
        </el-footer>
    </el-container>



    <script>
        evue = new Vue({
            el: '#equipment',
            data: {
                StoreDB_Equip: [],
                EquipDBDialogVisible: false,
                EquipSelectId: '',
                EquipSelectLabel: '',
                equipspartlist: [
                    { id: 'helm', label: '頭飾', equipname: '', effectlist: [] },
                    { id: 'armor', label: '衣服', equipname: '', effectlist: [] },
                    { id: 'weaponr', label: '主手', equipname: '', effectlist: [] },
                    { id: 'weaponl', label: '左手', equipname: '', effectlist: [] },
                    { id: 'robe', label: '披肩', equipname: '', effectlist: [] },
                    { id: 'shoes', label: '靴子', equipname: '', effectlist: [] },
                    { id: 'acc1', label: '飾品', equipname: '', effectlist: [] },
                    { id: 'acc2', label: '飾品', equipname: '', effectlist: [] },
                    { id: 'shadow', label: '影子', equipname: '', effectlist: [] },
                    { id: 'costume', label: '服飾', equipname: '', effectlist: [] },
                ],
                effecttypelist: [
                    { label: 'Atk', id: 'Atk', totalvalue: '', opersymbol: '\+', suffixsymbol: '' },
                    { label: 'Atk %', id: 'AtkPercent', totalvalue: '', opersymbol: '\+', suffixsymbol: '\%' },
                    { label: 'Matk', id: 'Matk', totalvalue: '', opersymbol: '\+', suffixsymbol: '' },
                    { label: 'Matk %', id: 'MatkPercent', totalvalue: '', opersymbol: '\+', suffixsymbol: '\%' },
                    { label: '種族 %', id: 'RacePercent', totalvalue: '', opersymbol: '\+', suffixsymbol: '\%' },
                    { label: '體型 %', id: 'SizePercent', totalvalue: '', opersymbol: '\+', suffixsymbol: '\%' },
                    { label: '屬性 %', id: 'ElementalPercent', totalvalue: '', opersymbol: '\+', suffixsymbol: '\%' },
                    { label: '階級 %', id: 'LevelPercent', totalvalue: '', opersymbol: '\+', suffixsymbol: '\%' },
                    { label: '爆傷 %', id: 'CriDamagePercent', totalvalue: '', opersymbol: '\+', suffixsymbol: '\%' },
                    { label: '遠傷 %', id: 'RangedDamagePercent', totalvalue: '', opersymbol: '\+', suffixsymbol: '\%' },
                    { label: '無視防禦 %', id: 'BypassDEFPercent', totalvalue: '', opersymbol: '\+', suffixsymbol: '\%' },
                    { label: 'ASPD', id: 'ASPD', totalvalue: '', opersymbol: '\+', suffixsymbol: '' },
                    { label: '攻擊後延%', id: 'AspedPercent', totalvalue: '', opersymbol: '\-', suffixsymbol: '\%' },
                    { label: '爆擊率 %', id: 'Cri', totalvalue: '', opersymbol: '\+', suffixsymbol: '\%' },
                    { label: '變詠 %', id: 'VariableCastPercent', totalvalue: '', opersymbol: '\-', suffixsymbol: '\%' },
                    { label: '固詠', id: 'FixedCast', totalvalue: '', opersymbol: '\-', suffixsymbol: 's' },
                    { label: '固詠 %', id: 'FixedCastPercent', totalvalue: '', opersymbol: '\-', suffixsymbol: '\%' },
                    { label: '霸氣', id: 'Mettle', totalvalue: '', opersymbol: 'lv', suffixsymbol: '' },
                ],
                fallenwarrior_Mettle: [
                    { id: 1, atkpercent: 3, hit: 3 },
                    { id: 2, atkpercent: 6, hit: 6 },
                    { id: 3, atkpercent: 9, hit: 9 },
                    { id: 4, atkpercent: 12, hit: 12 },
                    { id: 5, atkpercent: 15, hit: 15 },
                    { id: 6, atkpercent: 18, hit: 18 },
                    { id: 7, atkpercent: 21, hit: 21 },
                    { id: 8, atkpercent: 24, hit: 24 },
                    { id: 9, atkpercent: 27, hit: 27 },
                    { id: 10, atkpercent: 33, hit: 30 }
                ],
                EquipEffectDialogVisible: false,
                effectdialogue: {
                    EffectType: '',
                    EffectNumber: ''
                },
                weapontypelist: [
                    { id: 'Daggers', label: '短劍', sizefix: { small: 100, middle: 75, big: 50 }, baseaspd: '' },
                    { id: 'OneHandedSwords', label: '單手劍', sizefix: { small: 75, middle: 100, big: 75 }, baseaspd: '' },
                    { id: 'TwoHandedSword', label: '雙手劍', sizefix: { small: 75, middle: 75, big: 100 }, baseaspd: '' },
                    { id: 'Katars', label: '拳刃', sizefix: { small: 75, middle: 100, big: 75 }, baseaspd: '' },
                    { id: 'Spears', label: '矛類', sizefix: { small: 75, middle: 75, big: 100 }, baseaspd: '' },
                    { id: 'Axes', label: '斧類', sizefix: { small: 50, middle: 75, big: 100 }, baseaspd: '' },
                    { id: 'Maces', label: '鈍器', sizefix: { small: 75, middle: 100, big: 100 }, baseaspd: '' },
                    { id: 'Knuckles', label: '拳套', sizefix: { small: 100, middle: 100, big: 75 }, baseaspd: '' },
                    { id: 'Rods', label: '杖類', sizefix: { small: 100, middle: 100, big: 100 }, baseaspd: '' },
                    { id: 'Books', label: '書本', sizefix: { small: 100, middle: 100, big: 50 }, baseaspd: '' },
                    { id: 'Bows', label: '弓', sizefix: { small: 100, middle: 100, big: 75 }, baseaspd: '' },
                    { id: 'Instruments', label: '樂器', sizefix: { small: 75, middle: 100, big: 75 }, baseaspd: '' },
                    { id: 'Whips', label: '鞭子', sizefix: { small: 75, middle: 100, big: 75 }, baseaspd: '' },
                    { id: 'Guns', label: '槍', sizefix: { small: 100, middle: 100, big: 100 }, baseaspd: '' },
                    { id: 'Shuriken', label: '手裏劍', sizefix: { small: 75, middle: 75, big: 100 }, baseaspd: '' },
                ],
                lefthandweapon: false,
                weaponlevellist: [
                    { id: 1, label: '一級武器', upgradeatk: 2, saferefine: 7, overatk: 3 },
                    { id: 2, label: '二級武器', upgradeatk: 3, saferefine: 6, overatk: 5 },
                    { id: 3, label: '三級武器', upgradeatk: 5, saferefine: 5, overatk: 8 },
                    { id: 4, label: '四級武器', upgradeatk: 7, saferefine: 4, overatk: 14 }
                ],
                weapon: {
                    type: '', sizefix: '', level: '',
                    ATK: 0, MATK: 0, ArrowATK: 0, BulletATK: 0,
                    refinelevel: 0, refineatk: 0, refineatk2: 0
                },
                status: {
                    Level: 1,
                    STR: 0, AGI: 0, VIT: 0, INT: 0, DEX: 0, LUK: 0,
                    STR_Add: 0, AGI_Add: 0, VIT_Add: 0, INT_Add: 0, DEX_Add: 0, LUK_Add: 0,
                    STR_Total: 0, AGI_Total: 0, VIT_Total: 0, INT_Total: 0, DEX_Total: 0, LUK_Total: 0,
                },
                attritube: {
                    StatusATK: 0, WeaponATK: 0, StatusMATK: 0, WeaponMATK: 0,
                    ATK: 0, MATK: 0, ATKP: 0, MATKP: 0, DEF: 0, MDEF: 0,
                    ASPD: 0, AspedPercent: 0, CRI: 0, VCT: 0, FCT: 0, HIT: 0
                },
                sizetypelist: [
                    { id: 0, label: '小型' },
                    { id: 1, label: '中型' },
                    { id: 2, label: '大型' },
                ],
                elementtypelist: [
                    { id: 0, label: '無' },
                    { id: 1, label: '火' },
                    { id: 2, label: '水' },
                    { id: 3, label: '風' },
                    { id: 4, label: '地' },
                    { id: 5, label: '毒' },
                    { id: 6, label: '聖' },
                    { id: 7, label: '暗' },
                    { id: 8, label: '念' },
                    { id: 9, label: '不死' }
                ],
                elementlevel: [{ id: 1 }, { id: 2 }, { id: 3 }, { id: 4 }],
                elementalmap: [
                    100, 100, 100, 100, 100, 100, 100, 100, 70, 100,
                    100, 25, 90, 100, 150, 100, 75, 100, 100, 125,
                    100, 150, 25, 90, 100, 100, 75, 100, 100, 100,
                    100, 100, 175, 25, 90, 100, 75, 100, 100, 100,
                    100, 90, 100, 150, 25, 100, 75, 100, 100, 100,
                    100, 125, 100, 125, 125, 0, 75, 50, 100, -25,
                    100, 100, 100, 100, 100, 100, 0, 125, 100, 150,
                    100, 100, 100, 100, 100, 50, 125, 0, 100, -25,
                    70, 100, 100, 100, 100, 100, 75, 75, 125, 100,
                    100, 100, 100, 100, 100, 50, 100, 0, 100, 0,
                    100, 100, 100, 100, 100, 100, 100, 100, 50, 100,
                    100, 0, 80, 100, 175, 100, 50, 75, 100, 150,
                    100, 175, 0, 80, 100, 100, 50, 75, 100, 100,
                    100, 100, 175, 0, 80, 100, 50, 75, 100, 100,
                    100, 80, 100, 175, 0, 100, 50, 75, 100, 100,
                    100, 125, 75, 125, 125, 0, 50, 25, 75, -50,
                    100, 100, 100, 100, 100, 100, -25, 150, 100, 175,
                    100, 100, 100, 100, 100, 25, 150, -25, 100, -50,
                    50, 75, 75, 75, 75, 75, 50, 50, 150, 125,
                    100, 75, 75, 75, 75, 25, 125, 0, 100, 0,
                    100, 100, 100, 100, 100, 100, 100, 100, 0, 100,
                    100, -25, 70, 100, 200, 100, 25, 50, 100, 175,
                    100, 200, -25, 70, 100, 100, 25, 50, 100, 125,
                    100, 100, 200, -25, 70, 100, 25, 50, 100, 100,
                    100, 70, 100, 200, -25, 100, 25, 50, 100, 75,
                    100, 100, 50, 100, 100, 0, 25, 0, 50, -75,
                    100, 100, 100, 100, 100, 125, -50, 175, 100, 200,
                    100, 100, 100, 100, 100, 0, 175, -50, 100, -75,
                    0, 50, 50, 50, 50, 50, 25, 25, 175, 150,
                    100, 50, 50, 50, 50, 0, 150, 0, 100, 0,
                    100, 100, 100, 100, 100, 100, 100, 100, 0, 100,
                    100, -50, 60, 100, 200, 75, 0, 25, 100, 200,
                    100, 200, -50, 60, 100, 75, 0, 25, 100, 150,
                    100, 100, 200, -50, 60, 75, 0, 25, 100, 100,
                    100, 60, 100, 200, -50, 75, 0, 25, 100, 50,
                    100, 75, 25, 75, 75, 0, 0, -25, 25, -100,
                    100, 75, 75, 75, 75, 125, -100, 200, 100, 200,
                    100, 75, 75, 75, 75, -25, 200, -100, 100, -100,
                    0, 25, 25, 25, 25, 25, 0, 0, 200, 175,
                    100, 25, 25, 25, 25, -25, 175, 0, 100, 0
                ],
                enemyattribute: {
                    name: '',
                    level: 0, hp: 0, VIT: 0, INT: 0,
                    elemental: 0, elementallevel: 1, size: '',
                    StatusDEF: 0, WeaponDEF: 0,
                    StatusMDEF: 0, WeaponMDEF: 0,
                    sizeResist: 0, levelResist: 0, elementalResist: 0, moneletResist: 0,
                },
                enemylist: [],
                option:
                {
                    AttackElementalIdx: 0,      //玩家攻擊屬性
                    ElementalPercent: 0,        //屬性倍率

                    MaximizePower: false,       //武器值最大化
                    WeaponPerfection: false,    //無視體型攻擊
                    Riding: false,              //騎乘

                    MagnumBreak: false,         //怒爆
                    MagnumBreakValue: 20,
                    EnchantDeadlyPoison: false,  //致命塗毒
                    EnchantDeadlyPoisonValue: 25,
                    EnchantDeadlyPoisonPercent: 300,
                    MagnumPoison2Value: 0,    //怒爆致毒

                    VENOMIMPRESS: false,            //毒耐性弱化
                    VENOMIMPRESSValue: 50,
                    Striking: false,            //打擊強化
                    GentleTouchCharge: false,   //點穴-反
                    MettleLevel: 0,         //霸氣等級

                    WeaponMasteryATK: 0,     //武器修練本身

                    SkillPercent: 0,
                    Concentration: false,       //集中攻擊
                    ConcentrationValue: 25,
                    Berserk: false,             //狂怒之槍
                    BerserkValue: 200,
                    Overthrust: false,          //兇砍
                    OverthrustValue: 25,
                    OverthrustMax: false,       //兇砍最大值
                    OverthrustMaxValue: 100,
                    AdvancedKatarReserch: false,    //高階拳刃修練
                    AdvancedKatarReserchValue: 20,
                    //TODO[戰斧颶風]的風屬性武器增傷125%
                    EquipSkillAddDamage: 0,     //裝備技能增傷

                    Critical: false,
                    CriticalValue: 40,        //爆擊

                    ChangeRangedFormuraOrder: false,    //before
                },
                computeattribute:
                {
                    floatatk: 0,
                    elementalpercent: 0,
                    sizefix: 0,
                    enemydef: 0,

                    atkc0_min: 0,//武器基礎ATK x [ 1 + ( STR ÷ 200 ) - ( 武器等級 x 0.05 ) 
                    atkc0_max: 0,//武器基礎ATK x [ 1 + ( STR ÷ 200 ) + ( 武器等級 x 0.05 ) 

                    atkc1_min: 0,   // atkc0 + 精煉ATK  + 特殊技能加值打擊強化、點穴(半) )
                    atkc1_max: 0,   // atkc0 + 精煉ATK  + 特殊技能加值打擊強化、點穴(半) )

                    atkc2_min: 0,   //(atkc1 x 體形修正 + 箭矢ATK)
                    atkc2_max: 0,   //(atkc1 x 體形修正 + 箭矢ATK)

                    weaponatk_min: 0,   //(atkc2 x ( 1 + 怒爆20％ 或  致命塗毒25%(二選一)  x  屬性表 ) + 卡裝ATK))
                    weaponatk_max: 0,

                    atkequip_min: 0,    //x ( 1 + 種族ATK% ) x ( 1 + 體型ATK% ) x ( 1 + 致命塗毒300% ) x (1 + 屬性ATK% ) x ( 1 + 階級ATK% )
                    atkequip_max: 0,

                    atkbranch_min: 0,   //x (霸氣ATK% + ATK% )
                    //x 對方( 1 - 體型減傷% ) x ( 1 - 階級減傷% ) x ( 1 - 攻擊屬性減傷% ) x ( 1 - 怪物屬性減傷% )
                    //+ 砲彈ATK
                    atkbranch_max: 0,

                    atkc4_min: 0,   //weaponatk_min + this.computeattribute.atkbranch_min
                    atkc4_max: 0,   //weaponatk_max + this.computeattribute.atkbranch_max

                    atkc5_min: 0,   //atkc4_min x 屬性倍率 x (1 + 毒耐性弱化50%) x (使用左手武器時 1 - 25%) + 素質ATK x 2+ 修煉ATK + 武器強悍
                    atkc5_max: 0,   //atkc4_max x 屬性倍率 x (1 + 毒耐性弱化50%) x (使用左手武器時 1 - 25%) + 素質ATK x 2+ 修煉ATK + 武器強悍

                    atkc6_min: 0,   //x 本身 ( 1 + 遠距增傷% ) x ( 1 +暴擊增傷卡裝% )
                    //x 對方為喵族 ( 1 + 10% )x 對方 ( 1 -  遠距減傷% ) x ( 1 - 種族減傷%) x ( 1 - 暴擊減傷%)
                    atkc6_max: 0,

                    atkc7_min: 0,   //x 本身( 技能倍率% x [戰斧颶風]的風屬性武器增傷125% + 集中攻擊25% + 凶砍25%或凶砍最大值100% + 狂怒之槍200% )
                    //x ( 高階拳刃修練等級 x 2% + 10%)
                    //x 對方 ( ( 4000 + 後DEF ) ÷ ( 4000 + 10 x 後DEF ) ) - 前DEF
                    atkc7_max: 0,

                    normalattack_min: 0,
                    normalattack_max: 0,
                    normalcritical: 0,

                    atkc8_min: 0,// x ( 1 + 技能增傷的卡裝%) x ( 1 + 技能增傷的技能% )
                    atkc8_max: 0,
                    /*
                    + 靈氣劍 (技能等級 x 20)
                    x ( 1 + 暴擊傷害40% )
                    x ( 致命爪痕 1 + 250% (限定近距離物理攻擊))
                    x ( 天使之怒或天罰(效果不累加) 1 + 100% )
                    x ( 二刀連擊 1 + 100% )
                    x ( 潛擊 1 + 30%(BOSS型怪為15%) )
                    x (右手修練等級 x 10% + 50% 或 左手修練等級 x 10% + 30%)
                    x 對方(1 + 抵抗魔法等級 x 20% )
                    x 對方(1 - 鋼筋鐵骨等級 x 20% )
                    x 對方(1 - 金剛不壞 90% )
                    x 對方(1 - 俯身 90% )
                    */
                }
            },
            methods: {
                CombineEquipsAttribute() {
                    this.effecttypelist.forEach(element => {
                        var result = 0;
                        result = Enumerable.from(this.equipspartlist)
                            .where("($.effectlist).some(function (x) { return x.EffectType.id == '" + element.id + "'; })")
                            .select(function (x) {
                                var xx = x.effectlist.filter(x => x.EffectType.id == (element.id.toString()))
                                return Number(xx[0].EffectNumber);
                            })
                            .sum();
                        element.totalvalue = result;
                    });
                    this.ComputeATKAtttibute();
                    /*
                    //全身裝的 ATK 效果加總
                    //方法一
                    var idd = 'ATK'
                    var ef = Enumerable
                        .from(this.equipspartlist)
                        .where(function(e){ return e.effectlist.find(x=> x.EffectType.id == idd); })
                        //.select("value, index => value.effectlist.filter(x => x.EffectType.id == 'ATK')")
                        .select(function (x) {
                            var xx = x.effectlist.filter(x => x.EffectType.id == (element.id.toString()))
                            return Number(xx[0].EffectNumber);
                        })
                        .sum();
                    console.log(ef);
                    
                    //方法2 參考 https://stackoverflow.com/questions/33739726/linq-js-get-subitems
                    var result = Enumerable.from(this.equipspartlist)
                        .where("($.effectlist).some(function (x) { return x.EffectType.id == 'ATK'; })")
                        .select("Number($.effectlist[0].EffectNumber)")
                        .sum();

                    console.log("result:" + result);
                    */
                },
                AddEffect() {
                    if (this.effectdialogue.EffectNumber === '') { return; }

                    // 檢查已經存在該效果後覆蓋
                    if (this.equipspartlist[this.EquipSelectId].effectlist.length > 0) {
                        var index = this.equipspartlist[this.EquipSelectId].effectlist.findIndex(x => this.effectdialogue.EffectType.label === x.EffectType.label);

                        if (index > -1) {
                            this.equipspartlist[this.EquipSelectId].effectlist[index] = {
                                EffectNumber: Number(this.effectdialogue.EffectNumber),
                                EffectType: this.effectdialogue.EffectType
                            };
                            console.log("CoverEffect: " + this.equipspartlist[this.EquipSelectId].effectlist[index].EffectType + " /" + this.equipspartlist[this.EquipSelectId].effectlist[index].EffectNumber);

                            this.$set(this.equipspartlist[this.EquipSelectId].effectlist,
                                index,
                                {
                                    EffectNumber: Number(this.equipspartlist[this.EquipSelectId].effectlist[index].EffectNumber),
                                    EffectType: this.equipspartlist[this.EquipSelectId].effectlist[index].EffectType
                                })
                            this.effectdialogue.EffectNumber = '';
                            this.EquipEffectDialogVisible = false;
                            this.CombineEquipsAttribute();
                            return;
                        }
                    }
                    this.equipspartlist[this.EquipSelectId].effectlist.push({
                        EffectNumber: Number(this.effectdialogue.EffectNumber),
                        EffectType: this.effectdialogue.EffectType,
                    })
                    console.log("AddEffect: " + this.effectdialogue.EffectType + " /" + this.effectdialogue.EffectNumber);
                    this.effectdialogue.EffectNumber = '';
                    this.EquipEffectDialogVisible = false;
                    this.CombineEquipsAttribute();
                },
                RemoveEffect(eqindex, index) {
                    console.log("RemoveEffect: [" + eqindex + "] " + index);
                    //var index = this.equipspartlist[eqindex].indexOf(item)
                    if (index >= 0) {
                        this.equipspartlist[eqindex].effectlist.splice(index, 1)
                        this.CombineEquipsAttribute();
                    }
                },
                onSelectedDrug(item) {
                    console.log("onSelectedDrug " + item.label);
                },
                OpenEffectDialogue(eqindex) {
                    console.log("OpenDialogue " + eqindex);
                    this.EquipEffectDialogVisible = true;
                    this.EquipSelectId = eqindex;
                    this.EquipSelectLabel = this.equipspartlist[eqindex].label;
                },
                CloseEffectDialogue() {
                    this.EquipSelectId = '';
                },
                ComputRefineATK() {
                    this.weapon.refineatk = this.weapon.refinelevel * this.weaponlevellist[this.weapon.level.id - 1].upgradeatk;
                    if (this.weapon.refinelevel <= this.weaponlevellist[this.weapon.level.id - 1].saferefine) {
                        this.weapon.refineatk2 = 0;
                    }
                    else {
                        this.weapon.refineatk2 = (this.weapon.refinelevel - this.weaponlevellist[this.weapon.level.id - 1].saferefine)
                            * this.weaponlevellist[this.weapon.level.id - 1].overatk
                    }

                    if (this.weapon.type.id === 'Bows') {
                        this.weapon.refineatk2 = 0;
                    }
                },
                onSelectedWeaponLevel(item) {
                    this.ComputRefineATK();
                },
                onSelectedWeaponType(item) {
                    this.ChangeWeapon();
                },
                ChangeWeapon() {
                    this.weapon.sizefix = '小 ' + this.weapon.type.sizefix.small + '% / 中 ' +
                        this.weapon.type.sizefix.middle + '% / 大 ' + this.weapon.type.sizefix.big + '\%';
                    this.ComputRefineATK();
                    this.ComputeSizefix();
                },
                onChangeRefineLevel() {
                    this.ComputRefineATK();
                },
                onChaneStatus() {
                    this.status.STR_Total = Number(this.status.STR) + Number(this.status.STR_Add);
                    this.status.AGI_Total = Number(this.status.AGI) + Number(this.status.AGI_Add);
                    this.status.VIT_Total = Number(this.status.VIT) + Number(this.status.VIT_Add);
                    this.status.INT_Total = Number(this.status.INT) + Number(this.status.INT_Add);
                    this.status.DEX_Total = Number(this.status.DEX) + Number(this.status.DEX_Add);
                    this.status.LUK_Total = Number(this.status.LUK) + Number(this.status.LUK_Add);
                    this.ComputeATKAtttibute();
                },
                getElementalPercent(attackelementalid, enemyelemental, enemyelementlevel) {
                    var count = this.elementtypelist.length;
                    var _base = attackelementalid * count;
                    var _enemy = enemyelemental;
                    var _level = (enemyelementlevel - 1) * count * count
                    var percent = this.elementalmap[_base + _enemy + _level];
                    return percent;
                },
                ComputElementalPercent() {
                    this.option.ElementalPercent = this.getElementalPercent(
                        this.option.AttackElementalIdx,
                        this.enemyattribute.elemental,
                        this.enemyattribute.elementallevel);
                },
                ComputeSizefix() {
                    if (this.option.WeaponPerfection || this.option.Riding) {
                        this.computeattribute.sizefix = 100;
                        return;
                    }
                    switch (this.enemyattribute.size) {
                        case 0:
                            this.computeattribute.sizefix = this.weapon.type.sizefix.small;
                            break;
                        case 1:
                            this.computeattribute.sizefix = this.weapon.type.sizefix.middle;
                            break;
                        case 2:
                            this.computeattribute.sizefix = this.weapon.type.sizefix.big;
                            break;
                    }
                },
                ComputeATKAtttibute() {
                    // Math.ceil 進位  Math.floor 捨去 Math.round 4捨5入
                    this.attritube.StatusMATK = Math.floor(this.status.INT_Total * 1.5 + this.status.LUK_Total / 3 + this.status.Level / 4 + this.status.DEX_Total / 5);

                    var TempSTR = this.status.STR_Total;
                    var TempDEX = this.status.DEX_Total;
                    if (this.weapon.type.id === 'Bows' || this.weapon.type.id === 'Instruments' || this.weapon.type.id === 'Whips' || this.weapon.type.id === 'Guns') {
                        TempSTR = this.status.DEX_Total;
                        TempDEX = this.status.STR_Total;
                    }
                    var amu = this.lefthandweapon ? 1 : 1;
                    this.attritube.StatusATK = Math.floor(this.status.Level / 4 + TempSTR + TempDEX / 5 + this.status.LUK_Total / 3) * amu;

                    var para1 = TempSTR / 200;
                    var para2 = this.weapon.level.id * 0.05
                    this.computeattribute.atkc0_min = this.MulOper(Number(this.weapon.ATK), (1 + para1 - para2));
                    this.computeattribute.atkc0_max = this.MulOper(Number(this.weapon.ATK), (1 + para1 + para2));

                    var para3 = 0;
                    if (this.option.Striking)   //打擊強化
                    {
                        para3 = this.weapon.level.id * 18 + 100;
                    }
                    var para4 = 0;
                    if (this.option.GentleTouchCharge) {
                        para4 = (this.status.STR_Total / 2 + this.status.DEX_Total / 4) * 5 / 5;
                    }

                    this.computeattribute.atkc1_min = Number(this.computeattribute.atkc0_min) + Number(this.weapon.refineatk) + para3 + para4;
                    this.computeattribute.atkc1_max = Number(this.computeattribute.atkc0_max) + Number(this.weapon.refineatk) + para3 + para4;
                    this.computeattribute.atkc2_min = Number(this.computeattribute.atkc1_min) * (this.computeattribute.sizefix / 100) + Number(this.weapon.ArrowATK);
                    this.computeattribute.atkc2_max = Number(this.computeattribute.atkc1_max) * (this.computeattribute.sizefix / 100) + Number(this.weapon.ArrowATK);
                    if (this.computeattribute.sizefix < 100) {
                        this.computeattribute.atkc2_min = Math.floor(this.computeattribute.atkc2_min);
                        this.computeattribute.atkc2_max = Math.floor(this.computeattribute.atkc2_max);
                    }
                    var para5 = 0; //屬性
                    if (this.option.MagnumBreak) {
                        para5 = 1;
                    }
                    else if (this.option.EnchantDeadlyPoison) para5 = 5;
                    var para5value = this.getElementalPercent(para5,
                        this.enemyattribute.elemental,
                        this.enemyattribute.elementallevel);
                    var para6 = Number(1) + (this.option.MagnumPoison2Value / 100) * (para5value / 100);
                    this.computeattribute.weaponatk_min = this.MulOper(this.computeattribute.atkc2_min, para6);
                    this.computeattribute.weaponatk_max = this.MulOper(this.computeattribute.atkc2_max, para6);
                    this.computeattribute.weaponatk_min += Number(this.effecttypelist.find(x => x.id == 'Atk').totalvalue);
                    this.computeattribute.weaponatk_max += Number(this.effecttypelist.find(x => x.id == 'Atk').totalvalue);
                    var para_race = Number(1) + Number(this.effecttypelist.find(x => x.id == 'RacePercent').totalvalue) / 100;
                    var para_size = Number(1) + Number(this.effecttypelist.find(x => x.id == 'SizePercent').totalvalue) / 100;
                    var para_elemt = Number(1) + Number(this.effecttypelist.find(x => x.id == 'ElementalPercent').totalvalue) / 100;
                    var para_level = Number(1) + Number(this.effecttypelist.find(x => x.id == 'LevelPercent').totalvalue) / 100;
                    var para_posion = Number(1) + (this.option.EnchantDeadlyPoison ? (Number(this.option.EnchantDeadlyPoisonPercent / 100)) : Number(0));
                    this.computeattribute.atkequip_min = this.MulOper(this.computeattribute.weaponatk_min, para_race);
                    this.computeattribute.atkequip_max = this.MulOper(this.computeattribute.weaponatk_max, para_race);
                    this.computeattribute.atkequip_min = this.MulOper(this.computeattribute.atkequip_min, para_size);
                    this.computeattribute.atkequip_max = this.MulOper(this.computeattribute.atkequip_max, para_size);
                    this.computeattribute.atkequip_min = this.MulOper(this.computeattribute.atkequip_min, para_elemt);
                    this.computeattribute.atkequip_max = this.MulOper(this.computeattribute.atkequip_max, para_elemt);
                    this.computeattribute.atkequip_min = this.MulOper(this.computeattribute.atkequip_min, para_level);
                    this.computeattribute.atkequip_max = this.MulOper(this.computeattribute.atkequip_max, para_level);
                    this.computeattribute.atkequip_min = this.MulOper(this.computeattribute.atkequip_min, para_posion);
                    this.computeattribute.atkequip_max = this.MulOper(this.computeattribute.atkequip_max, para_posion);

                    var para_MettleATKPercent = 0;
                    var para_Mettlelevel = Number(this.effecttypelist.find(x => x.id == 'Mettle').totalvalue);
                    if (para_Mettlelevel > 0) para_MettleATKPercent = this.fallenwarrior_Mettle[para_Mettlelevel - 1].atkpercent;
                    var para_atkpercent = Number(this.effecttypelist.find(x => x.id == 'AtkPercent').totalvalue);

                    // 霸氣 ATK% 似乎不適用小於1進位
                    // 從MulOper改為Mathfloor 捨去
                    this.computeattribute.atkbranch_min = Math.floor(this.computeattribute.weaponatk_min *
                        (para_MettleATKPercent + para_atkpercent) / 100);
                    this.computeattribute.atkbranch_max = Math.floor(this.computeattribute.weaponatk_max *
                        (para_MettleATKPercent + para_atkpercent) / 100);
                    this.computeattribute.atkbranch_min = this.MulOper(this.computeattribute.atkbranch_min, Number(1) + Number(this.enemyattribute.sizeResist / 100));
                    this.computeattribute.atkbranch_max = this.MulOper(this.computeattribute.atkbranch_max, Number(1) + Number(this.enemyattribute.sizeResist / 100));
                    this.computeattribute.atkbranch_min = this.MulOper(this.computeattribute.atkbranch_min, Number(1) + Number(this.enemyattribute.levelResist / 100));
                    this.computeattribute.atkbranch_max = this.MulOper(this.computeattribute.atkbranch_max, Number(1) + Number(this.enemyattribute.levelResist / 100));
                    this.computeattribute.atkbranch_min = this.MulOper(this.computeattribute.atkbranch_min, Number(1) + Number(this.enemyattribute.elementalResist / 100));
                    this.computeattribute.atkbranch_max = this.MulOper(this.computeattribute.atkbranch_max, Number(1) + Number(this.enemyattribute.elementalResist / 100));
                    this.computeattribute.atkbranch_min = this.MulOper(this.computeattribute.atkbranch_min, Number(1) + Number(this.enemyattribute.moneletResist / 100));
                    this.computeattribute.atkbranch_max = this.MulOper(this.computeattribute.atkbranch_max, Number(1) + Number(this.enemyattribute.moneletResist / 100));
                    this.computeattribute.atkbranch_min += Number(this.weapon.BulletATK);
                    this.computeattribute.atkbranch_max += Number(this.weapon.BulletATK);

                    this.computeattribute.atkc4_min = this.computeattribute.atkequip_min + this.computeattribute.atkbranch_min;
                    this.computeattribute.atkc4_max = this.computeattribute.atkequip_max + this.computeattribute.atkbranch_max;

                    this.computeattribute.atkc5_min = this.MulOper(this.computeattribute.atkc4_min, Number(this.option.ElementalPercent / 100));
                    this.computeattribute.atkc5_max = this.MulOper(this.computeattribute.atkc4_max, Number(this.option.ElementalPercent / 100));
                    if (this.option.VENOMIMPRESS && this.option.AttackElementalIdx == 5) {
                        this.computeattribute.atkc5_min = this.MulOper(this.computeattribute.atkc5_min, Number(1) + Number(this.option.VENOMIMPRESSValue / 100));
                        this.computeattribute.atkc5_max = this.MulOper(this.computeattribute.atkc5_max, Number(1) + Number(this.option.VENOMIMPRESSValue / 100));
                    }
                    if (this.lefthandweapon) {
                        this.computeattribute.atkc5_min = this.MulOper(this.computeattribute.atkc5_min, Number(0.75));
                        this.computeattribute.atkc5_max = this.MulOper(this.computeattribute.atkc5_max, Number(0.75));
                    }
                    var para7 = (this.lefthandweapon ? Number(this.attritube.StatusATK) : Number(this.attritube.StatusATK * 2)) + Number(this.option.WeaponMasteryATK);
                    this.computeattribute.atkc5_min += para7;
                    this.computeattribute.atkc5_max += para7;


                    var para_ranged = Number(1) + Number(this.effecttypelist.find(x => x.id == 'RangedDamagePercent').totalvalue) / 100;
                    this.computeattribute.atkc6_min = this.MulOper(this.computeattribute.atkc5_min, para_ranged);
                    this.computeattribute.atkc6_max = this.MulOper(this.computeattribute.atkc5_max, para_ranged);

                    this.computeattribute.normalattack_min = this.computeattribute.atkc6_min;
                    this.computeattribute.normalattack_max = this.computeattribute.atkc6_max;

                    var para8 = Number(this.option.SkillPercent / 100);
                    para8 += this.option.Concentration ? this.option.ConcentrationValue : 0;
                    para8 += this.option.Berserk ? this.option.BerserkValue : 0;
                    para8 += this.option.Overthrust ? this.option.OverthrustValue : 0;
                    para8 += this.option.OverthrustMax ? this.option.OverthrustMaxValue : 0;
                    this.computeattribute.atkc7_min = this.MulOper(this.computeattribute.atkc6_min, para8);
                    this.computeattribute.atkc7_max = this.MulOper(this.computeattribute.atkc6_max, para8);
                    if (this.option.AdvancedKatarReserch) {
                        this.computeattribute.atkc7_min = this.MulOper(this.computeattribute.atkc7_min, Number(1) + Number(this.option.AdvancedKatarReserchValue / 100));
                        this.computeattribute.atkc7_max = this.MulOper(this.computeattribute.atkc7_max, Number(1) + Number(this.option.AdvancedKatarReserchValue / 100));
                    }
                    var parabypassDEF = Number(1) + Number(this.effecttypelist.find(x => x.id == 'BypassDEFPercent').totalvalue) / 100;
                    var para9 = ((4000 + this.MulOper(Number(this.enemyattribute.WeaponDEF), parabypassDEF)) /
                        (4000 + 10 * this.MulOper(Number(this.enemyattribute.WeaponDEF), parabypassDEF)));
                    this.option.enemydef = (para9 * 100).toFixed(2);
                    this.computeattribute.atkc7_min = Math.floor(this.computeattribute.atkc7_min * para9) - Number(this.enemyattribute.StatusDEF);
                    this.computeattribute.atkc7_max = Math.floor(this.computeattribute.atkc7_max * para9) - Number(this.enemyattribute.StatusDEF);
                    this.computeattribute.normalattack_min = Math.floor(this.computeattribute.normalattack_min * para9) - Number(this.enemyattribute.StatusDEF);
                    this.computeattribute.normalattack_max = Math.floor(this.computeattribute.normalattack_max * para9) - Number(this.enemyattribute.StatusDEF);

                    var para_crid = Number(1) + Number(this.effecttypelist.find(x => x.id == 'CriDamagePercent').totalvalue) / 100;
                    this.computeattribute.atkc8_min = this.MulOper(this.computeattribute.atkc7_min, para_crid);
                    this.computeattribute.atkc8_max = this.MulOper(this.computeattribute.atkc7_max, para_crid);
                    this.computeattribute.atkc8_min = this.MulOper(this.computeattribute.atkc8_min, Number(1) + Number(this.option.CriticalValue / 100));
                    this.computeattribute.atkc8_max = this.MulOper(this.computeattribute.atkc8_max, Number(1) + Number(this.option.CriticalValue / 100));
                    this.computeattribute.normalcritical = this.MulOper(this.computeattribute.normalattack_max, para_crid);
                    this.computeattribute.normalcritical = this.MulOper(this.computeattribute.normalattack_max, Number(1) + Number(this.option.CriticalValue / 100));

                    this.computeattribute.atkc8_min = this.MulOper(this.computeattribute.atkc8_min, Number(1) + Number(this.option.EquipSkillAddDamage / 100));
                    this.computeattribute.atkc8_max = this.MulOper(this.computeattribute.atkc8_max, Number(1) + Number(this.option.EquipSkillAddDamage / 100));

                },
                MulOper(value, percent) {
                    if (percent > 1) {
                        var _L = Math.floor(Number(value) * (Number(percent) * 100) / 100);
                        return _L;
                    }
                    if (percent < 1) {
                        return Math.ceil(Number(value) * (Number(percent) * 100) / 100);
                    }
                    return value * percent;
                },
                ComputeMATKAtttibute() {
                },
                onChangeEnemyStatus() {

                },
                onSelectEnemy(item) {
                    // 拿資料 傳值就好
                    //https://wcc723.github.io/javascript/2017/12/10/javascript-reference/
                    this.enemyattribute = Object.assign({}, item);
                    console.log("onSelectEnemy: " + this.enemyattribute.elemental);
                },
                initenemylist() {
                    this.enemylist[0] = { id: 0, name: '自訂', level: 1, elemental: 0, elementallevel: 1, size: 0, StatusDEF: 0, WeaponDEF: 0, StatusMDEF: 0, WeaponMDEF: 0, sizeResist: 0, levelResist: 0, elementalResist: 0, moneletResist: 0 };
                    this.enemylist[1] = { id: 1, name: '龍蛋', level: 150, elemental: 0, elementallevel: 1, size: 1, StatusDEF: 75, WeaponDEF: 120, StatusMDEF: 37.5, WeaponMDEF: 120, sizeResist: 0, levelResist: 0, elementalResist: 0, moneletResist: 0 };
                    this.enemylist[2] = { id: 2, name: '闇●十字斬首者', level: 179, elemental: 5, elementallevel: 4, size: 1, StatusDEF: 180, WeaponDEF: 0, StatusMDEF: 100, WeaponMDEF: 100, sizeResist: 0, levelResist: 0, elementalResist: 0, moneletResist: 0 };
                    this.enemylist[3] = { id: 3, name: '闇●魅影追蹤者', level: 178, elemental: 5, elementallevel: 4, size: 1, StatusDEF: 160, WeaponDEF: 0, StatusMDEF: 100, WeaponMDEF: 100, sizeResist: 0, levelResist: 0, elementalResist: 0, moneletResist: 0 };

                },
                onOptionStriking() {
                    this.status.CRI += this.option.Striking ? 5 : -5;
                    this.ComputeATKAtttibute();
                },
                onOptionGentleTouchCharge() {
                    var _p = this.status.AGI_Total * 5 / 60;
                    var _m = 200 / this.status.INT_Total * 5;
                    this.status.AspedPercent += this.option.GentleTouchCharge ? _p : -_p;
                    this.attritube.MDEF += this.option.GentleTouchCharge ? _m : -_m;
                    this.ComputeATKAtttibute();
                },
                onOptionMagnumBreak() {
                    if (this.option.MagnumBreak) {
                        this.option.MagnumPoison2Value = this.option.MagnumBreakValue;
                        this.option.EnchantDeadlyPoison = false;
                        this.option.AttackElementalIdx = 1;    //改變攻擊屬性 火
                    } else {
                        if (this.option.AttackElementalIdx === 1)
                            this.option.AttackElementalIdx = 0;    //改變攻擊屬性 無
                    }
                    if (this.option.MagnumBreak == false && this.option.EnchantDeadlyPoison == false) {
                        this.option.MagnumPoison2Value = 0;
                    }
                    this.ComputeATKAtttibute();
                },
                onOptionEnchantDeadlyPoison() {
                    if (this.option.EnchantDeadlyPoison) {
                        this.option.MagnumPoison2Value = this.option.EnchantDeadlyPoisonValue;
                        this.option.MagnumBreak = false;
                    }
                    if (this.option.MagnumBreak == false && this.option.EnchantDeadlyPoison == false) {
                        this.option.MagnumPoison2Value = 0;
                    }
                    this.ComputeATKAtttibute();
                },
                onOptionWeaponMastery() {
                    this.ComputeATKAtttibute();
                },
                onOptionConcentration() {
                    this.ComputeATKAtttibute();
                },
                onOptionBerserk() {
                    this.ComputeATKAtttibute();
                },
                onOptionOverthrust() {
                    if (this.option.Overthrust) {
                        this.option.OverthrustMax = false;
                    }
                    this.ComputeATKAtttibute();
                },
                onOptionOverthrustMax() {
                    if (this.option.OverthrustMax) {
                        this.option.Overthrust = false;
                    }
                    this.ComputeATKAtttibute();
                },
                onOptionAdvancedKatarReserch() {
                    this.ComputeATKAtttibute();
                },
                onOptionSkill() {
                    this.ComputeATKAtttibute();
                },
                onOptionCritical() {
                    this.ComputeATKAtttibute();
                },
                onSaveEquip(epidx) {
                    if (this.equipspartlist[epidx].equipname == '') return;
                    this.StoreDB_Equip.push({ uuid: this._uuid(), equip: this.equipspartlist[epidx] });
                    this.SaveEquipDB();
                },
                OpenEquipDBDialogDialogue() {
                    this.EquipDBDialogVisible = true;
                    if (localStorage.getItem('StoreDB_Equip')) {
                        try {
                            this.StoreDB_Equip = JSON.parse(localStorage.getItem('StoreDB_Equip'));
                            Enumerable.from(this.StoreDB_Equip).orderBy(x => x.equip.id);
                        } catch (e) {
                            console.log("catch e:" + e);
                        }
                    }
                },
                onLoadEquipSave(saveid) {
                    var idx = this.equipspartlist.findIndex(x => x.id == this.StoreDB_Equip[saveid].equip.id);
                    if (idx > -1) {
                        this.equipspartlist[idx] = this.StoreDB_Equip[saveid].equip;
                        this.CombineEquipsAttribute();
                    }
                },
                onRemoveEquipSave(saveid) {
                    if (saveid > -1) {
                        this.StoreDB_Equip.splice(saveid, 1)
                        this.SaveEquipDB();
                    }
                },
                SaveEquipDB() {
                    const parsed = JSON.stringify(this.StoreDB_Equip);
                    localStorage.setItem('StoreDB_Equip', parsed);
                },
                // 產生唯一碼 給存檔使用
                // https://cythilya.github.io/2017/03/12/uuid/
                _uuid() {
                    var d = Date.now();
                    if (typeof performance !== 'undefined' && typeof performance.now === 'function') {
                        d += performance.now(); //use high-precision timer if available
                    }
                    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                        var r = (d + Math.random() * 16) % 16 | 0;
                        d = Math.floor(d / 16);
                        return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);
                    });
                }
            },
            mounted() {
                console.log("mounted");
                this.effectdialogue.EffectType = this.effecttypelist[0];
                this.weapon = {
                    type: this.weapontypelist[0], level: this.weaponlevellist[0],
                    ATK: 0, MATK: 0, ArrowATK: 0, BulletATK: 0,
                    refinelevel: 0
                };
                this.ChangeWeapon();
                this.option.AttackElementalIdx = 0;
                this.initenemylist();
                this.enemyattribute = this.enemylist[0];
                this.ComputElementalPercent();

            }

        })

        evue.$watch('enemyattribute', function (newB, oldB) {
            console.log("Watch enemyattribute ");
            this.ComputElementalPercent();
            this.ComputeSizefix();
            this.ComputeATKAtttibute();
        }, {
            deep: true
        });

        evue.$watch('weapon', function (newB, oldB) {
            console.log("Watch weapon ");
            this.ComputeATKAtttibute();
        }, {
            deep: true
        });

    </script>

    <body>

</html>